{% extends "layouts/base.html" %}

{% load static %}

{% block title %} Wallet {% endblock %}

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}{% endblock stylesheets %}

{% block content %}


<div class="row mb-2 mt-4">
    <div class="col-sm-8 align-items-center">
        <h1 class="fw-extrabold mb-0">Students</h1>
    </div>
</div>

<div class="row mt-4">
    <div class="col-sm-8">

        <div class="row">
            <div class="col-12 mb-4">
                <div class="card border-0 shadow">
                    <div class="card-header">
                        <div class="row align-items-center">
                            <div class="col-sm-6">
                                <div class="card w-100 shadow">
                                  <div class="card-body p-3">
                                    <div class="row">
                                        <div class="col-sm-8 d-flex align-items-center">
                                            <i class="material-icons">group</i>
                                            <p class="card-text py-0 my-0 mx-3">Total students</p>
                                        </div>
                                        <div class="col-sm-4 d-flex align-items-center justify-content-end">
                                            <h4 class="card-title py-0 my-0">{{all_students.count}}</h4>
                                        </div>
                                    </div>
                                  </div>
                                </div>
                            </div>

                            <div class="col-sm-6">
                                <div class="card w-100 shadow">
                                  <div class="card-body p-3">
                                    <div class="row">
                                        <div class="col-sm-8 d-flex align-items-center">
                                            <i class="material-icons">villa</i>
                                            <p class="card-text py-0 my-0 mx-3">Total department</p>
                                        </div>
                                        <div class="col-sm-4 d-flex align-items-center justify-content-end">
                                            <h4 class="card-title py-0 my-0">{{total_departments}}</h4>
                                        </div>
                                    </div>
                                  </div>
                                </div>
                            </div>
                            
                            <!-- <div class="col text-end">
                                <a href="#" class="btn btn-sm btn-primary">See all</a>
                            </div> -->
                        </div>
                    </div>
                    <div class="table-responsive">
                        <table class="table align-items-center table-flush">
                            <thead class="thead-light">
                            <tr>
                                <th class="border-bottom" scope="col">Student</th>
                                <th class="border-bottom" scope="col">Roll no.</th>
                                <th class="border-bottom" scope="col">Joined since</th>
                                <th class="border-bottom" scope="col">Type</th>
                            </tr>
                            </thead>
                            <tbody>
                            
                            {% if not all_students %}

                            <tr>
                                <td colspan="4">
                                    <div class="alert alert-warning text-center my-2" role="alert">
                                        <strong>No students registered</strong>
                                    </div>
                                    
                                </td>

                            </tr>

                            {% endif %}

                        
                            {% if single_student %}

                            <tr style="background-color:#eeeeee;">
                                <th class="text-gray-900" scope="row">
                                    
                                    <div class="d-flex align-items-center">
                                        <img style="width: 50px; height:50px; border-radius:100px" src="media/{{ single_student.profile_picture }}" alt="">
                                        <div class="mx-3">
                                            <p class="mb-1">{{ single_student.user.first_name }} {{ single_student.user.last_name }}</p>
                                            <span style="color: #aaaaaa;">{{ single_student.user.email }}</span>
                                        </div>
                                    </div>

                                
                                </th>
                                <td class="fw-bolder text-gray-500">
                                    {{ single_student.roll_no }}
                                </td>
                                <td class="fw-bolder text-gray-500">
                                    {{ single_student.added_at.date }}

                                </td>
                                <td class="fw-bolder text-gray-500">
                                    <a href="{% url 'students:view-student' single_student.id %}">
                                        <button type="button" name="" id="" class="btn btn-primary btn-sm">View</button>
                                    </a>
                                </td>
                            </tr>

                            {% endif %}

                            
                            {% for student in all_students %}
                            <tr {% if single_student.id == student.id %}style="background-color:#eeeeee; display:none"{% endif %}>
                                <th class="text-gray-900" scope="row">
                                    <div class="d-flex align-items-center">
                                        <img style="width: 50px; height:50px; border-radius:100px" src="media/{{ student.profile_picture }}" alt="">
                                        <div class="mx-3">
                                            <p class="mb-1">{{ student.user.first_name }} {{ student.user.last_name }}</p>
                                            <span style="color: #aaaaaa;">{{ student.user.email }}</span>
                                        </div>
                                    </div>

                                
                                </th>
                                <td class="fw-bolder text-gray-500">
                                    {{ student.roll_no }}
                                </td>
                                <td class="fw-bolder text-gray-500">
                                    {{ student.added_at.date }}

                                </td>
                                <td class="fw-bolder text-gray-500">
                                    <a href="{% url 'students:view-student' student.id %}">
                                        <button type="button" name="" id="" class="btn btn-primary btn-sm">View</button>
                                    </a>
                                </td>
                            </tr>

                            {% endfor %}
                            
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
           
        </div>

    </div>


    
    <div class="col-sm-4 pb-4">
        {% if single_student %}

        <div class="card border-0 shadow">
   
            <div class="card-header py-0 pt-3 border-bottom-0">
                <div class="row">
                    <div class="col-sm-10">
                        <div class="d-block my-0 d-flex align-items-center">
                            <img style="width: 80px; height:80px; border-radius:100px" src="media/{{single_student.profile_picture}}" alt="">
                            <div class="mx-3 text-left">
                                <span class="mb-0 mx-1 mb-2 text-primary" style="font-size: 15px">Roll no.</span>
                                <!-- <p class="mb-0 mx-1 mb-2">Account</p> -->
                                <h3 class="mb-1 mt-2 mx-1 text-primary"><b>{{single_student.roll_no}}</b></h3>
                            </div>
        
                         </div>

                    </div>
                    
                    <div class="col-sm-2 d-flex align-items-center justify-content-center">
                        <div 
                            role="button" 
                            onclick="switchId()"  
                            >
                            <!-- <i class="fas fa-ellipsis-v fa-sm fa-fw text-gray-400"></i> -->
                            <span class="material-icons text-secondary" style="font-size: 30px;">
                                360
                            </span>
                        </div>
                    </div>
                </div>
              
            </div>

            <div class="card-body p-0">
                <div>


                    <div class="card radius-10 border-0" >

                        {% if not single_student.id_card_front_pic or not single_student.id_card_back_pic %}

                        <div class="text-center my-3 mt-4">

                              <img src="{% static 'notfound.png' %}" style="width: 130px; opacity: 0.6;" alt="">

                              <h6 class="my-3" style="color: #cccccc;">No id card added</h6>
                        </div>


                        {% else %}

                            <div class="card-body text-center">
        
                                                            
                                <div class="flip-card">
                                    <div class="flip-card-inner">
                                        <div class="flip-card-front">
                                            <img src="media/{{ single_student.id_card_front_pic }}" class="width-100" alt="">
                                        </div>
                                        <div class="flip-card-back">
                                            <img src="media/{{ single_student.id_card_back_pic }}" class="width-100" alt="">
                                        </div>
                                    </div>
                                </div>
                                
                            </div>


                        {% endif %}


                    </div>
    

                </div>


                <div>
                    <div class="p-4 py-0">
                        <div class="card mb-4 border shadow">
                            
                            <div class="table-responsive table-striped">
                                <table class="table align-items-center table-flush">
                                    <thead class="thead-light">
                                        <tr>
                                            <th class="border-0" scope="col" colspan="2">
                                                Student Info
                                                {% if is_current_paid %}
                                                
                                                    <span class="badge bg-success mx-2">Current voucher paid</span>


                                                {% endif %}
                                            </th>
                                            
                                        </tr>
                                    </thead>
                                    <tbody>
                                    
                                 
        
                                    <tr>
                                        <th class="text-gray-900" scope="row">
                                            Name
                                        </th>
                                        <td class="fw-bolder text-gray-500">
                                            {{ single_student.user.first_name }} {{ single_student.user.last_name }}
                                        </td>
                                    </tr>
                                    <tr>
                                        <th class="text-gray-900" scope="row">
                                            Email
                                        </th>
                                        <td class="fw-bolder text-gray-500">
                                            {{ single_student.user.username }}
                                        </td>
                                    </tr>
                                    
                                    <tr>
                                        <th class="text-gray-900" scope="row">
                                            Phone
                                        </th>
                                        <td class="fw-bolder text-gray-500">
                                            {{ single_student.phone }}
                                        </td>
                                    </tr>
        
                      
                                    
                                    </tbody>
                                </table>
                            </div>

                        </div>
                    </div>
         
              
                  
                

                </div>
            </div>
       
    
  

        </div>

        {% else %}

        <div class="card shadow">
            <div class="card-body p-2">
                <div class="row" style="height: 550px;">
                    <div class="col-sm-12 py-5 my-5 d-flex align-items-center justify-content-center">
                        <div class="text-center">
                            <img src="{% static 'notfound.png' %}" style="width: 150px; opacity: 0.6;" alt="">
                            <div class="h4 fw-normal text-gray my-4" style="color: grey;">No student selected</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>



        {% endif %}
    </div>

</div>

<script>
    var button = false;
    function switchId() {
        if (!(button)) {
            $(".flip-card-inner, .profile-card").css("transform", "rotateY(180deg)");
        }else{
            $(".flip-card-inner, .profile-card").css("transform", "rotateY(360deg)");
        }
        button = !(button);
    }

</script>

{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}{% endblock javascripts %}